# 调试指南

## 调试模式

为了方便开发和调试，应用程序支持直接启动特定的对话框窗口。

### 使用方法

#### 方法 1：使用批处理脚本（推荐）

直接双击运行以下脚本：

- `debug-settings.bat` - 调试设置对话框
- `debug-history.bat` - 调试历史记录对话框

#### 方法 2：使用命令行

```bash
# 调试设置对话框
dotnet run -- --debug-settings

# 调试历史记录对话框
dotnet run -- --debug-history

# 查看所有调试选项
dotnet run -- --debug
```

#### 方法 3：在 Visual Studio 中调试

1. 右键点击项目 → 属性
2. 在"调试"选项卡中，找到"应用程序参数"
3. 输入 `--debug-settings` 或其他调试参数
4. 按 F5 开始调试

### 调试选项说明

- `--debug` - 显示所有可用的调试选项
- `--debug-settings` - 直接打开设置对话框（用于调试打印机配置）
- `--debug-history` - 直接打开历史记录对话框

### 调试设置对话框

当使用 `--debug-settings` 启动时：

1. 应用程序会直接打开设置对话框
2. 可以测试打印机选择、纸张尺寸配置
3. 可以测试"测试打印"功能
4. 所有的 Console.WriteLine 日志会输出到控制台

### 注意事项

- 调试模式下，数据库和配置文件仍然会正常加载
- 如果数据库不存在，会自动创建默认配置
- 测试打印需要选择一个 PDF 文件
- 确保系统中已安装打印机驱动

### 查看日志

所有的日志输出都会显示在控制台中，包括：

- `[PrintService]` - 打印服务相关日志
- 数据库操作日志
- 配置加载日志
- 错误和异常信息

### 常见问题

**Q: 测试打印没有反应？**
A: 检查控制台日志，查看是否有错误信息。常见原因：
   - 打印机名称不正确
   - 纸张尺寸无效
   - PDF 文件路径不存在
   - 打印机驱动问题

**Q: 如何重置配置？**
A: 删除应用数据目录中的 `config.db` 文件，应用会重新创建默认配置。

**Q: 找不到打印机？**
A: 点击"刷新打印机"按钮，或检查系统打印机设置。
