# OCR识别区域配置说明

## 概述

OCR识别区域现在可以通过配置文件进行调整，无需修改代码。

## 配置位置

配置存储在数据库中的 `AppConfig` 对象中，包含两个识别区域：

1. **TrackingNumberRegion** - 快递单号识别区域
2. **PackageCountRegion** - 件数识别区域

## 坐标系统

使用相对坐标系统（0-1范围）：
- **X**: 水平位置（0=最左边，1=最右边）
- **Y**: 垂直位置（0=最上边，1=最下边）
- **Width**: 宽度（相对于图像宽度）
- **Height**: 高度（相对于图像高度）

## 默认配置

### 快递单号识别区域
```
X: 0.05 (左边距5%)
Y: 0.85 (距顶部85%)
Width: 0.5 (宽度50%)
Height: 0.08 (高度8%)
```
识别目标：左下角的"邮政特快专递 · 1372274827526"

### 件数识别区域
```
X: 0.7 (左边距70%)
Y: 0.45 (距顶部45%)
Width: 0.25 (宽度25%)
Height: 0.15 (高度15%)
```
识别目标：右侧中间的"9件"

## 如何调整

### 方法1：通过设置界面（推荐）
未来可以在设置界面中添加OCR区域配置功能，提供可视化调整。

### 方法2：直接修改数据库
1. 打开数据库文件（LiteDB）
2. 找到 `AppConfig` 集合
3. 修改 `TrackingNumberRegion` 或 `PackageCountRegion` 的值
4. 重启应用

### 方法3：通过代码初始化
在 `Models/AppConfig.cs` 中修改默认值：

```csharp
public OcrRegion TrackingNumberRegion { get; set; } = new()
{
    X = 0.05f,      // 调整这些值
    Y = 0.85f,
    Width = 0.5f,
    Height = 0.08f
};
```

## 调试技巧

1. OCR服务会将裁剪后的图像保存到临时目录
2. 查看调试输出中的路径，例如：
   ```
   裁剪图像已保存到: C:\Users\...\Temp\ocr_debug_eng_20260129123456.png
   ```
3. 打开这些图像，检查识别区域是否正确
4. 根据实际情况调整坐标值

## 示例：调整识别区域

如果快递单号位置变化了，例如移到了右下角：

```csharp
TrackingNumberRegion = new()
{
    X = 0.5f,       // 从左边50%开始
    Y = 0.85f,      // 距顶部85%
    Width = 0.45f,  // 宽度45%
    Height = 0.08f  // 高度8%
}
```

## 注意事项

1. 坐标值必须在 0-1 范围内
2. X + Width 不应超过 1
3. Y + Height 不应超过 1
4. 区域太小可能导致识别失败
5. 区域太大可能包含干扰信息
